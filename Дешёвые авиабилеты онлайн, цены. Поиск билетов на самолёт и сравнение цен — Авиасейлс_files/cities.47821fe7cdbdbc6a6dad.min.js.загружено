"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[9342],{10020:function(e,t,n){n.d(t,{d:function(){return s}});var i=n(89717),r=n(36094);const a={name:"cities_widgets",dataTransformer:function(e){var t;const n=e.widgets.countryBestDirectionsV1;return n?{...n,prices:(null===(t=n.prices)||void 0===t?void 0:t.map((e=>({...e,countryIata:n.code}))))||null}:null}},s=async e=>{const{currency:t,limit:n,userCitizenship:s,language:o,locale:l,tripParams:c}=e,u=(e=>{let{language:t,locale:n,...i}=e;return`{\n    widgets {\n      countryBestDirectionsV1(${function(e){return Object.entries(e).filter((e=>{let[t,n]=e;return n})).map((e=>{let[t,n]=e;return n&&"dates"===t&&"string"!=typeof n&&"number"!=typeof n?`${t}: { ${i=n,i?Object.entries(i).filter((e=>{let[t,n]=e;return n})).map((e=>{let[t,n]=e;return"period"===t?`${t}: ${n}`:`${t}: ${JSON.stringify(n)}`})).join(", "):null} }`:`${t}: ${JSON.stringify(n)}`;var i})).join(", ")}({...i,locale:n})}) {\n        code\n        name\n        total\n        prices {\n          open\n          imageUrl\n          imageUrlRetina\n          iata\n          value\n          destination {\n            translations(filter: { locales: ["${t}"] })\n          }\n        }\n      }\n    }\n  }`})({currency:t,limit:n,language:o,locale:l,destinationCountry:(null==c?void 0:c.destinationIata)??null,origin:(null==c?void 0:c.originIata)??null,dates:(0,r.Tw)((null==c?void 0:c.departDate)??void 0,(null==c?void 0:c.returnDate)??void 0),passportCountry:s});try{return await i.N.createRequest()({query:u,config:a})}catch(e){return null}}},45024:function(e,t,n){n.r(t),n.d(t,{Cities:function(){return we}});var i=n(67294),r=n(34840),a=n(81468),s=n(19347),o=n(97179),l=n(16849),c=n(83409),u=n(12588),d=n(41671),p=n(63246),f=n(54423),m=n(34943),g=n(55230),x=n(53088),y=n(49767),h=n(23927),v=n(74526),j=n(73114),C=n(36094),b=n(10020),S=n(11155),$=n(99289);const{$paxCount:D}=g.i.outputs,{$currency:M}=x.y.outputs,{$language:I}=y.l.outputs,{$localeDeprecated:T}=h.z.outputs,{$userCitizenship:w}=v.W.outputs,{$tripParams:k}=g.i.outputs,P=S.citiesDomain.createEffect(b.d,{sid:"aw515k"}),E=S.citiesDomain.createEvent({sid:"qda8d6"}),{$enabled:N,turnOn:O,turnOff:A}=(0,m.MR)({sid:"-dgpifx",fn:()=>(0,j.qs)()}),F=S.citiesDomain.createStore(null,{sid:"-a3c9pg"}),_=(0,m.$e)({and:[F,D,(e,t)=>null!=e&&e.prices?(0,C.hl)(e.prices,t):[]],or:{sid:"r8gg7p"}}),z=(0,m.$e)({and:[{loading:P.pending,data:_}],or:{sid:"8ndfrv"}}),B=(0,m.ub)({and:{source:[I,T,M,k,$.hS,w],mapParams:(e,t)=>{let[n,i,r,a,s,o]=t;return{language:n,locale:i,currency:r,limit:s,tripParams:a,userCitizenship:o}},effect:P},or:{sid:"-5wggh6"}});F.on(P.doneData,((e,t)=>t)).on(E,(()=>null)),(0,m.UP)({and:[{clock:N,source:F,filter:(e,t)=>!e&&t,target:B}],or:{sid:"-j1t0s1"}}),(0,m.UP)({and:[{clock:w.updates,source:N,filter:Boolean,target:B}],or:{sid:"-ixygmi"}}),(0,m.UP)({and:[{clock:S.$isVisible,filter:e=>!e,target:[E,A]}],or:{sid:"-iik80e"}}),(0,m.UP)({and:[{clock:k,target:E}],or:{sid:"h2rdek"}});var L=n(74371),U=n(49250);const W=S.citiesDomain.createStore(!1,{sid:"-dzt1zi"}),{openSnackbar:V,closeSnackbar:R}=(0,m.LC)({and:[W,{openSnackbar:()=>!0,closeSnackbar:()=>!1}],or:{sid:"js4xx"}});(0,m.UP)({and:[{clock:[L.X.aviaForm.inputs.aviaFormSubmitted,U.Vx.aviaFormSubmitted],filter:S.$isVisible,target:V}],or:{sid:"pbascv"}});var Y=n(41609),Q=n.n(Y),q=n(94184),X=n.n(q),J=n(76540),H=n(866),K=n(96799),Z={root:"sX38o2X3a2iiQAXSRzt3",opened:"AaR6fOCnjZl5F3MJyNlV",closed:"ooAPdn88bVVe5jVjsZJQ",text:"A6TlLLEos5jetUPrMCsc"},G=n(85893);const ee=e=>{let{type:t,className:n}=e;const{t:i}=(0,a.useTranslation)("widget_cities");return(0,G.jsx)("div",{className:X()(Z.root,Z[t],n),children:(0,G.jsx)(H.Text,{tag:"span",type:H.TextType.Body3Semi,className:Z.text,transformOnMobile:!0,children:i("opened"===t?"opened":"closed")})})},te=(0,i.memo)(ee);let ne;!function(e){e.Opened="opened",e.Closed="closed"}(ne||(ne={}));var ie="IFFD7_lFv6sjYX8i3yv1";const re=e=>{var t;let{city:n,currency:i,extraSize:s,className:o}=e;const{t:l}=(0,a.useTranslation)("widget_cities"),{destination:c,open:u,imageUrl:p,iata:f,countryIata:m,imageUrlRetina:g,value:x}=n,{isImageLoaded:h,onImageLoad:v}=(0,d.h3)(),{fillDestinationFn:j,language:C}=(0,r.eY)({fillDestinationFn:S.fillDestination,language:y.l.outputs.$language}),b=(null===(t=c.translations[C])||void 0===t?void 0:t.su)||"";return(0,G.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),j({iata:f,name:b,type:K.PlaceType.City,countryIata:m})},className:X()("PpLFTz7U2xM_fgQoYLgq",o),"data-test-id":"city-card",children:(0,G.jsxs)("figure",{className:X()("NFIEO6Sysri_REuj4WFY",s&&"uF_iy2O9keJ1nCKN80Do"),children:[(0,G.jsxs)("picture",{className:X()("ebJUeEp2mTER02MyEZ3I",!h&&"Y0Xr39CHXgi7eTaKHsw5"),children:[(0,G.jsx)("img",{className:"wPl278gjS1n9sCsktoAQ",loading:"lazy",src:p,srcSet:`${g} 2x`,onLoad:v,alt:b}),null!==u&&(0,G.jsx)(te,{type:u?ne.Opened:ne.Closed,className:"v1__Rtsx5nSBQZowIQWo"})]}),(0,G.jsxs)("figcaption",{className:"WM5tEe_JGk_L3rYL1cOJ",children:[(0,G.jsx)(H.Text,{type:H.TextType.Body1Semi,className:ie,transformOnMobile:!0,testId:"city-name",children:b}),(0,G.jsx)(H.Text,{type:H.TextType.Body2Regular,className:ie,transformOnMobile:!0,testId:"no-price",children:i&&x?(0,G.jsx)(a.Trans,{defaults:l("priceFrom"),components:{price:(0,G.jsx)(J.Price,{value:x,currency:i,showCurrencySign:!0,testId:"city-price"})}}):l("getPrice")})]})]})})};var ae=n(88956);const se=e=>{let{onClick:t,total:n}=e;const{isMobile:i}=(0,r.eY)({isMobile:f.l.$isMobile}),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{t:n}=(0,a.useTranslation)("widget_cities"),i=e>100;return t?i?n("showRoundedCitiesShort"):n("showAllCitiesShort",{totalCities:e}):i?n("showRoundedCities"):n("showAllCities",{totalCities:e})}(n,i);return(0,G.jsx)(ae.Button,{priority:ae.ButtonPriority.Secondary,size:ae.ButtonSize.M,className:X()("uey8WDP7UMxk2B85lXL_",i&&"zkCKDLnDisZ2z32lx_3n"),onClick:t,testId:"all-city-button",children:s})};let oe;!function(e){e.Preview="preview",e.Full="full"}(oe||(oe={}));var le={extraSize:"mnOWZm1hWcFUP_nN2aUi",base:"fxwgztQt0jJWo4shJaDz",preview:"nqRziusMQkEoBABNiuHf",full:"a_Bj9OIVitj5UIz3UT0k",list:"TE124xWA5Zw5nnO7NMxn",link:"Lh9kaRb2nPdNbn6OAeDf",city:"wvpOh1PVYClooCGtWVLf",item:"P6ImQac1SV7U4vJq8QPt",action:"MPbxS7tBfrqQtTAlEVAn"};const ce=e=>{let{data:t,viewMode:n,children:a}=e;const{isMobile:s,currency:o}=(0,r.eY)({isMobile:f.l.$isMobile,currency:x.y.outputs.$currency}),l=function(e){return i.Children.toArray(e).map((e=>{if(!e)return null;const t=e;return t.type===se?(0,i.cloneElement)(t):null}))}(a);return(0,G.jsxs)("ul",{className:X()(le.base,[s&&n!==oe.Full&&le.list,n&&le[n]]),"data-test-id":"city-list",children:[t.map((e=>(0,G.jsx)("li",{className:le.item,children:(0,G.jsx)(re,{city:e,currency:o,className:le.city,extraSize:n===oe.Full})},e.iata))),!Q()(l)&&(0,G.jsx)("li",{className:le.action,children:l})]})};ce.Button=se;var ue=n(7547),de=n(21297),pe=n(77875),fe=n(73368),me=n(46845),ge=n(3786),xe=n(13099),ye=n(51081),he=n(10924);const{createReporter:ve}=he.I.inputs,je={category:"country",label:"cities_block",service:ye.Service.Explore},Ce={pageName:"main",source:null},be=(0,m.yM)({sid:"-g5cncn"}),Se=(0,m.yM)({sid:"z2s2zd"}),$e=ve({data:{...je,action:"opened"}}),De=ve({data:{...je,action:"showed"}});$e({clock:Se,payload:e=>({...Ce,userEvent:!0,platform:e.platform,exploreId:e.exploreId})}),De({clock:be,payload:e=>({...Ce,userEvent:!1,platform:e.platform,exploreId:e.exploreId})});const Me=()=>{const{t:e}=(0,a.useTranslation)("widget_cities"),{data:t,loading:n}=(0,r.eY)(z),{isModalOpened:o,closeModalFn:l,openModalFn:c}=(0,r.eY)({isModalOpened:N,closeModalFn:A,openModalFn:O}),u=(0,de.useModalBehavior)("CITIES_MODAL_NAME",(0,fe.addExternalStateConnection)({externalVisibility:o,onClose:l,onOpen:c}));return function(e){const{exploreId:t,citiesWidgetOpenedFn:n}=(0,r.eY)({exploreId:xe.Q.outputs.$exploreId,citiesWidgetOpenedFn:Se});(0,i.useEffect)((()=>{e&&n({exploreId:t,platform:ge.formattedPlatformName})}),[t,e,n])}(o),(0,G.jsxs)(ue.Modal,{...u,padding:[24,48],className:"gRGI62oyMZurUNDFa1C0",dataTestId:"all-cities-modal",children:[(0,G.jsxs)(ue.Modal.Navigation,{children:[(0,G.jsx)(pe.Navbar.Title,{title:e("title")}),(0,G.jsx)(pe.Navbar.RightAccessory,{children:(0,G.jsx)(me.CloseButton,{onClick:l,"data-test-id":"close-cities-modal-button"})})]}),n?(0,G.jsx)(s.Spinner,{}):(0,G.jsx)(ce,{data:t,viewMode:oe.Full})]})};var Ie=n(97650);const Te=()=>{const{t:e}=(0,a.useTranslation)("widget_cities"),{data:t,total:n,loading:m}=(0,r.eY)($.uX),{ref:g}=function(){const{exploreId:e,widgetShown:t}=(0,r.eY)({exploreId:xe.Q.outputs.$exploreId,widgetShown:be}),[n,a]=(0,Ie.YD)({threshold:.75,triggerOnce:!0});return(0,i.useEffect)((()=>{a&&t({exploreId:e,platform:ge.formattedPlatformName})}),[e,a,t]),{ref:n}}(),{cities:x,remainder:y}=function(e,t){const n=(0,r.eY)(f.l.$isTablet);return e.length?n?{cities:e.slice(0,C.rW.TABLET),remainder:Math.max(t-C.rW.TABLET,0)}:{cities:e.slice(0,C.rW.DESKTOP),remainder:Math.max(t-C.rW.DESKTOP,0)}:{cities:[],remainder:0}}(t,n),{isClient:h,isMobile:v,isSnackbarVisible:j,openModalFn:b,closeSnackbarFn:S}=(0,r.eY)({isClient:p.y.outputs.$isClient,isMobile:f.l.$isMobile,isSnackbarVisible:W,openModalFn:O,closeSnackbarFn:R});return 0===t.length?null:(0,G.jsxs)("div",{ref:g,children:[(0,G.jsx)(d.fw,{name:"fade",in:!0,appear:!0,children:(0,G.jsxs)(u.A,{children:[(0,G.jsxs)(u.A.Header,{children:[(0,G.jsx)(u.A.Title,{children:e("title")}),v&&(0,G.jsxs)(u.A.HeaderButton,{onClick:b,children:[e("showAllCitiesHeader"),(0,G.jsx)(l.Icon16ControlsDisclosure,{})]})]}),m?(0,G.jsx)(s.Spinner,{}):(0,G.jsx)(ce,{data:x,viewMode:oe.Preview,children:y>0&&(0,G.jsx)(ce.Button,{onClick:b,total:y})}),(0,G.jsx)(Me,{})]})}),h&&(0,G.jsx)(o.Snackbar,{icon:(0,G.jsx)(c.Icon24ColorWarning,{}),message:e("pickCity"),onClose:S,visible:j})]})},we=()=>(0,r.eY)(S.$isVisible)?(0,G.jsx)(i.StrictMode,{children:(0,G.jsx)(Te,{})}):null},36094:function(e,t,n){n.d(t,{Tw:function(){return o},hl:function(){return s},rW:function(){return a}});var i=n(6229),r=n(91486);const a={TABLET:8,DESKTOP:8,MOBILE:8};function s(e,t){return e.map((e=>e.value&&t>1?{...e,value:e.value*t}:e))}function o(e,t){if(!e)return null;if(Array.isArray(e)){const n=e.map((e=>(0,i.getDateISO)(e))),a=null==t?void 0:t.min,s=null==t?void 0:t.max;return{period:r.ae.FLEXIBLE,departMonths:n,minTripDuration:a,maxTripDuration:s}}return{period:r.ae.EXACT,departDate:(0,i.getDateISO)(e),oneWay:!t,returnDate:t&&(0,i.getDateISO)(t)}}},11155:function(e,t,n){n.r(t),n.d(t,{$isVisible:function(){return P},$isWidgetEnabled:function(){return k},citiesDomain:function(){return y.g},citiesInitialized:function(){return I},fillDestination:function(){return w},hide:function(){return N},setDirectionSource:function(){return T},show:function(){return E}});var i=n(34943),r=n(31409),a=n(65740),s=n(73114),o=n(55230),l=n(53088),c=n(13099),u=n(64441),d=n(17514),p=n(97331),f=n(1445),m=n(74526),g=n(77195),x=n(91486),y=n(38071),h=n(99289);const{$destinationIsCountry:v}=o.i.outputs,{citiesFlag:j}=u.i.outputs,{requestCitiesFlags:C}=u.i.inputs,{$isAviaFormActive:b}=d.B.outputs,{$isSimpleSearch:S}=p.N.outputs,{$currency:$}=l.y.outputs,{$tripParams:D}=o.i.outputs,{$userCitizenship:M}=m.W.outputs,I=y.g.createEvent({sid:"u2xjqx"}),T=c.Q.inputs.directionSourceUpdated.prepend((()=>x.yh.Country)),w=y.g.createEvent({sid:"cf3eut"}),k=(0,r.y)({stores:[j.$value,b,S,v],predicate:!0}),{$enabled:P,turnOn:E,turnOff:N}=(0,i.MR)({sid:"mgxswl",fn:()=>(0,s.qs)()});(0,i.UP)({and:[{clock:I,target:C}],or:{sid:"7zhxmo"}}),(0,i.UP)({and:[{clock:I,filter:k,target:E}],or:{sid:"828wlh"}}),(0,a.s)({source:k.updates,if:k,then:E,else:N}),(0,i.UP)({and:[{clock:[E,$.updates,D.updates,M.updates],filter:k,target:h.fN}],or:{sid:"8kxwrr"}}),(0,i.UP)({and:[{clock:w,target:[g.H,f.q.inputs.fillDestination,T]}],or:{sid:"92jbrb"}})},38071:function(e,t,n){n.d(t,{g:function(){return i}});const i=(0,n(34943).Fj)({sid:"r7axgm"})},99289:function(e,t,n){n.d(t,{fN:function(){return h},hS:function(){return C},uX:function(){return S}});var i=n(34943),r=n(55230),a=n(53088),s=n(49767),o=n(23927),l=n(74526),c=n(36094),u=n(10020),d=n(38071);const{$paxCount:p}=r.i.outputs,{$currency:f}=a.y.outputs,{$language:m}=s.l.outputs,{$localeDeprecated:g}=o.z.outputs,{$userCitizenship:x}=l.W.outputs,{$tripParams:y}=r.i.outputs,h=d.g.createEvent({sid:"8u8e0y"}),v=d.g.createEffect(u.d,{sid:"-mr9qr3"}),j=d.g.createStore(null,{sid:"-hb94we"}).on(v.doneData,((e,t)=>t)),C=j.map((e=>(null==e?void 0:e.total)??0)),b=(0,i.$e)({and:[j,p,(e,t)=>null!=e&&e.prices?(0,c.hl)(e.prices,t):[]],or:{sid:"a6jfua"}}),S=(0,i.$e)({and:[{total:C,loading:v.pending,data:b}],or:{sid:"-79xi53"}});(0,i.UP)({and:[{clock:h,source:{language:m,locale:g,currency:f,tripParams:y,userCitizenship:x},fn:e=>{let{language:t,locale:n,currency:i,tripParams:r,userCitizenship:a}=e;return{language:t,locale:n,currency:i,tripParams:r,userCitizenship:a,limit:c.rW.DESKTOP}},target:v}],or:{sid:"-td2aix"}})}}]);