"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6711],{76838:function(e,t,s){s.r(t),s.d(t,{AutosearchWidget:function(){return m}});var r=s(67294),a=s(34840),o=s(50261),i=s(81468),c=s(94184),n=s.n(c),u=s(12588),l=s(41671),d=s(77606),h=s.n(d),p=s(97650);const g="prices_autosearch";var f=s(85893);const{$noTickets:k,$scoringSortFlag:S}=o.autosearchPublicApi.outputs,A=()=>{const{t:e}=(0,i.useTranslation)("widget_prices"),{ref:t}=function(){const e=(0,a.eY)({notEmpty:o.autosearchPublicApi.outputs.$tickets.map((e=>!h()(e))),viewed:o.autosearchPublicApi.inputs.autosearchTicketsViewed}),[t,s]=(0,p.YD)({threshold:.5});return(0,r.useEffect)((()=>{s&&e.notEmpty&&e.viewed()}),[s,e]),{ref:t}}(),{noTickets:s,scoringSortFlag:c}=(0,a.eY)({noTickets:k,scoringSortFlag:S}),d=function(){const[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!1),o=document.getElementById(g),i=(0,r.useCallback)((()=>{a(!0)}),[]);return(0,r.useEffect)((()=>{if(!e&&o){const e=new MutationObserver(i);e.observe(o,{childList:!0,subtree:!0}),t(e)}}),[e,o,i]),(0,r.useEffect)((()=>{s&&e&&e.disconnect()}),[s,e]),(0,r.useEffect)((()=>()=>{e&&e.disconnect()}),[e,o]),s}(),A=e((null==c?void 0:c.enabled)?"suitableTickets":"bestPrices");return(0,f.jsx)("div",{ref:t,children:(0,f.jsx)(u.A,{className:n()(!d&&"uXZ2lQnef5GPFJtV3z3p"),"data-testid":"prices-autosearch",children:(0,f.jsxs)(l.fw,{in:!0,name:"fade",appear:!0,children:[!s&&(0,f.jsx)(u.A.Header,{children:(0,f.jsx)(u.A.Title,{children:(0,f.jsx)(i.Trans,{defaults:A,components:{control:(0,f.jsx)(f.Fragment,{})}})})}),(0,f.jsx)("div",{id:g})]})})})},{$isVisible:v}=o.autosearchPublicApi.outputs,m=()=>(0,a.eY)(v)?(0,f.jsx)(r.StrictMode,{children:(0,f.jsx)(A,{})}):null},50261:function(e,t,s){s.r(t),s.d(t,{autosearchPublicApi:function(){return Ze}});var r=s(34943),a=s(29260),o=s(31409),i=s(35529),c=s(65041),n=s(64441),u=s(26793),l=s(34242),d=s(49250),h=s(53088),p=s(17514),g=s(97331),f=s(69368),k=s(96799),S=s(85839);const A=(0,r.Fj)({sid:"-xf620n"}),{autosearchFlag:v}=n.i.outputs,{$aviaForm:m,aviaFormChanged:$,multiwaySegmentsChanged:w}=d.Vx,{$currency:b}=h.y.outputs,{$searchStatus:E}=u.u8.outputs,{$isSimpleSearch:x}=g.N.outputs,{$isAviaFormActive:P}=p.B.outputs,y=A.createEvent({sid:"-2juswb"}),T=A.createEvent({sid:"-orf6s5"}),F=A.createEvent({sid:"6sigmo"}),V=A.createEvent({sid:"-t1xzh2"}),U=A.createEvent({sid:"-h9rhmo"}),j=A.createEvent({sid:"-sq3m3r"}),_=A.createEvent({sid:"oah1ou"}),C=(0,a.m)({events:[y,w],reset:$}),z=(0,r.$e)({and:[m,b,(e,t)=>({...e,currency:t})],or:{sid:"-bm4plp"}}),B=A.createStore([],{sid:"-wln1kg"}),D=A.createStore(!1,{sid:"-i2t47c"}),I=A.createStore(null,{sid:"raii0g"}),L=B.map((function(e){return e.filter((e=>"debug"!==e.chunk_id)).reduce(((e,t)=>[...e,...t.tickets]),[])})),O=(0,r.$e)({and:[L,E,function(e,t){return t===k.SearchStatus.Failed||t===k.SearchStatus.Finished&&0===e.length}],or:{sid:"mrd4xk"}}),N=m.map((function(e){return Boolean((null==e?void 0:e.departDate)&&!Array.isArray(null==e?void 0:e.departDate))&&(0,S.bx)(null==e?void 0:e.origin,null==e?void 0:e.destination)})),R=A.createStore(!1,{sid:"y42m9k"}),q=(0,o.y)({predicate:!0,stores:[P,x,N,v.$value]}),M=(0,r.$e)({and:[l.jm.outputs.$withoutVisaTransfersValue,l.jm.outputs.$baggageValue,l.jm.outputs.$directValue,(e,t,s)=>({withoutVisa:!s&&e,transfersCount:s?["0"]:[],baggage:t})],or:{sid:"-vdlbg5"}}),Y={outputs:{$isVisible:q,$tickets:L,$noTickets:O,$scoringSortFlag:c.f.inputs.createFlag({name:f.TT.ScoringSort,contract:(0,i.Record)({enabled:i.Boolean}),defaultValue:{enabled:!1},requestOn:y}).$value},inputs:{initialized:y,autosearchTicketsViewed:_},internals:{$filters:M,$chunks:B,$isAutosearchShown:R,$autosearchId:I,$autosearchTrigger:z,$autosearchTicketsViewed:D,hideAutosearch:V,showAutosearch:F,startAutosearch:T,continueAutosearch:U,abortAutosearch:j,initialMultiwaySegmentsChanged:C}};var H=s(4588),K=s.n(H),Q=s(25387),G=s.n(Q),J=s(27183),W=s.n(J),X=s(23190),Z=s(20787),ee=s(23588),te=s(42176),se=s(25015);const{$autosearchTrigger:re,$filters:ae,$isAutosearchShown:oe,$autosearchId:ie,$autosearchTicketsViewed:ce,$chunks:ne,hideAutosearch:ue,showAutosearch:le,startAutosearch:de,continueAutosearch:he,abortAutosearch:pe}=Y.internals,{$isVisible:ge}=Y.outputs,{initialized:fe,autosearchTicketsViewed:ke}=Y.inputs,{initialMultiwaySegmentsChanged:Se}=Y.internals,{searchAbort:Ae}=ee.z.outputs,{chunksLoaded:ve,searchMetaLoaded:me}=se.E.outputs,{$searchStatus:$e,searchStarted:we}=u.u8.outputs,{startAutosearchFx:be,showAutosearchFx:Ee,hideAutosearchFx:xe}=Z.c.outputs,{$isComplexSearch:Pe}=g.N.outputs,{autosearchFlag:ye}=n.i.outputs,{requestAutosearchFlags:Te}=n.i.inputs;let Fe;(0,r.UP)({and:[{clock:fe,target:Te}],or:{sid:"d1a7u1"}}),ne.on(ve,((e,t)=>[...e,...t])).reset(we),ie.on(me,((e,t)=>W()(null,"search_id",t))).reset(re),ce.on(ke,(()=>!0)).reset(re),oe.on(le,(()=>!0)).on(ue,(()=>!1)),(0,r.UP)({and:[{clock:pe,fn:()=>"autosearch aborted",target:Ae}],or:{sid:"dzx97s"}}),(0,r.UP)({and:[{clock:ae,source:{exploreFiltes:ae,serpFilters:te.j.outputs.$filtersState.map((e=>K()(["withoutVisa","transfersCount","baggage"],e))),isAutosearchShown:oe},filter:e=>{let{exploreFiltes:t,serpFilters:s,isAutosearchShown:r}=e;return!G()(t,s)&&r},target:he}],or:{sid:"eerp8j"}}),(0,r.UP)({and:[{clock:he,source:ae,fn:e=>({changes:e,source:f.ng.ExploreFilters}),target:te.j.inputs.filtersChangedByUser}],or:{sid:"ey0i06"}}),(0,r.UP)({and:[{clock:ge,source:oe,filter:(e,t)=>!e&&t,target:le}],or:{sid:"ff24ed"}}),(0,r.UP)({and:[{clock:ge,source:oe,filter:(e,t)=>e&&!t,target:ue}],or:{sid:"3kv12i"}}),(0,r.UP)({and:[{clock:ue,source:$e,filter:e=>e===k.SearchStatus.Started,target:pe}],or:{sid:"3opl81"}}),(0,r.UP)({and:[{clock:Se,source:{searchParams:X.D.outputs.$searchParams,isEnabled:ye.$value,isComplexSearch:Pe},filter:e=>{let{searchParams:t,isEnabled:s,isComplexSearch:r}=e;return t.has("with_request")&&s&&r},target:de}],or:{sid:"443tu5"}}),(0,r.UP)({and:[{clock:[re,oe],source:oe,filter:Boolean,target:de}],or:{sid:"4m91f2"}}),(0,r.UP)({and:[{clock:le,target:Ee}],or:{sid:"51na16"}}),(0,r.UP)({and:[{clock:ue,target:xe}],or:{sid:"54e8zz"}}),(0,r.UP)({and:[{clock:de,target:be}],or:{sid:"5iowfd"}}),function(e){e.AutosearchSchedule="autosearch-schedule",e.AutosearchTickets="autosearch-tickets"}(Fe||(Fe={}));var Ve=s(3786),Ue=s(51081),je=s(10924),_e=s(13099);const{createReporter:Ce}=je.I.inputs,{allTicketsShown:ze}=Z.c.outputs,{searchStarted:Be}=u.u8.outputs,{$autosearchId:De}=Y.internals,Ie=A.createEvent({sid:"ye93sw"}),Le=A.createEvent({sid:"-l9nnwd"}),Oe=A.createEvent({sid:"16fi0x"}),Ne=A.createEvent({sid:"-v5wijh"}),Re=(0,a.m)({events:{allTicketsShown:ze,autosearchIdUpdated:De.updates},reset:Be}),qe={outputs:{},inputs:{},internals:{$payload:(0,r.$e)({and:[De,_e.Q.outputs.$exploreId,(e,t)=>({pageName:"main",source:null,exploreId:t,searchId:e,platform:Ve.formattedPlatformName,service:Ue.Service.Explore})],or:{sid:"-kfa7p6"}}),listingOpenedReport:Ce({data:{category:"ticket_offers",label:"listing",action:"opened",service:Ue.Service.Explore}}),blockShowedReport:Ce({data:{category:"ticket_offers",label:"block",action:"showed",service:Ue.Service.Explore}}),prepareAutosearchViewPayload:Ie,prepareAllTicketsShowPayload:Le,sendAutosearchViewAnalytics:Oe,sendAutosearchShowAllTicketsAnalytics:Ne,triggeredAllTicketsShowEvent:Re}},{allTicketsShown:Me}=Z.c.outputs,{$autosearchId:Ye,$autosearchTicketsViewed:He}=Y.internals,{$payload:Ke,listingOpenedReport:Qe,blockShowedReport:Ge,prepareAutosearchViewPayload:Je,prepareAllTicketsShowPayload:We,triggeredAllTicketsShowEvent:Xe}=qe.internals;(0,r.UP)({and:[{clock:He,source:Ye,filter:Boolean,target:Je}],or:{sid:"-49rzmh"}}),Ge({clock:(0,r.UP)({and:[{clock:Je,source:Ke}],or:{sid:"-oghz6x"}}),payload:e=>({...e,userEvent:!1,ticketOfferType:Fe.AutosearchTickets})}),(0,r.UP)({and:[{clock:[Xe,Me],source:Ye,filter:Boolean,target:We}],or:{sid:"-3b4y8q"}}),Qe({clock:(0,r.UP)({and:[{clock:We,source:Ke}],or:{sid:"-op3zb2"}}),payload:e=>({userEvent:!0,...e})});const Ze={...Y}}}]);